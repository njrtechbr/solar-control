
# Product Requirements Document (PRD) - SolarView Pro

**Versão:** 1.0
**Data:** 25 de Julho de 2024
**Autor:** App Prototyper AI
**Status:** Em Desenvolvimento

---

## 1. Visão Geral e Introdução

O SolarView Pro é uma plataforma web completa projetada para otimizar e centralizar o gerenciamento de todo o ciclo de vida de instalações de sistemas de energia solar fotovoltaica. A solução visa resolver a fragmentação de informações, a falta de visibilidade em tempo real e a ineficiência nos processos que afetam empresas de instalação, desde o primeiro contato com a concessionária até a homologação final e o monitoramento pós-instalação.

O sistema oferece três interfaces distintas e integradas para atender às necessidades de cada envolvido no processo:
1.  **Painel Administrativo (`/admin`):** Uma central de controle para a equipe interna (back-office) gerenciar projetos, clientes, equipamentos e fluxos de trabalho.
2.  **Formulário do Instalador (`/`):** Uma interface web otimizada para dispositivos móveis, permitindo que técnicos de campo submetam relatórios detalhados diretamente do local da instalação.
3.  **Página de Status do Cliente (`/status/[id]`):** Um portal público onde o cliente final pode acompanhar o progresso de sua instalação de forma transparente.

A aplicação utiliza o **`localStorage` do navegador como principal meio de armazenamento de dados**, garantindo que as informações persistam na máquina do usuário sem a necessidade de um banco de dados externo na versão atual.

---

## 2. Personas de Usuário

### 2.1. **Ana - Gerente de Operações (Back-office)**
-   **Descrição:** Ana é responsável por coordenar todas as instalações, desde o recebimento de uma nova venda até a homologação final. Ela precisa de uma visão clara do status de todos os projetos, gerenciar a alocação de equipes e equipamentos, e garantir que a documentação esteja em ordem.
-   **Necessidades:** Visibilidade completa do pipeline, ferramentas para gerenciar múltiplos projetos simultaneamente, rastreabilidade de eventos, e comunicação eficiente com a equipe de campo.
-   **Pontos de Dor Atuais:** Uso de planilhas descentralizadas, dificuldade em saber o status real das instalações, perda de tempo buscando informações e documentos.

### 2.2. **Carlos - Técnico Instalador**
-   **Descrição:** Carlos é o técnico de campo que realiza as instalações. Ele trabalha em diferentes locais e precisa de uma maneira rápida e eficiente para registrar dados técnicos, medições elétricas e documentação fotográfica no final de cada serviço.
-   **Necessidades:** Um formulário simples, rápido, otimizado para celular, que funcione bem em condições de campo e que consolide todas as informações necessárias em um único envio.
-   **Pontos de Dor Atuais:** Preenchimento de formulários de papel que podem ser perdidos, envio de fotos e informações via múltiplos canais (WhatsApp, email), e retrabalho para corrigir informações faltantes.

### 2.3. **Sra. Lúcia - Cliente Final**
-   **Descrição:** Sra. Lúcia contratou a instalação de um sistema solar em sua residência. Ela está ansiosa para ver o projeto concluído, mas não entende os detalhes técnicos do processo.
-   **Necessidades:** Uma forma simples e clara de saber em que pé está sua instalação, sem precisar ligar constantemente para a empresa.
-   **Pontos de Dor Atuais:** Incerteza sobre o progresso, falta de comunicação proativa por parte da empresa instaladora.

---

## 3. Histórias de Usuário e Requisitos Funcionais

### Épico 1: Gestão Centralizada no Painel Administrativo (`/admin`)

| ID   | Como uma (Persona)         | Eu quero...                                                                                                       | Para que...                                                                                              | Requisitos Funcionais Chave                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| :--- | :------------------------- | :---------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **1.1**  | Ana, Gerente de Operações  | ter uma visão geral de todas as instalações em andamento em um quadro Kanban.                                     | eu possa rapidamente identificar gargalos e entender o status de cada projeto.                          | - **4 Dashboards Kanban:** Páginas distintas para `Instalação`, `Projeto`, `Homologação` e `Relatório` em `/admin/dashboard/[tipo]`.<br>- **Colunas Dinâmicas:** As colunas do Kanban são geradas a partir dos status definidos nas configurações (ver 1.8), com contadores de cards em cada uma.<br>- **Drag-and-Drop:** Arrastar um card (instalação) entre colunas atualiza seu status correspondente no `localStorage`.<br>- **Evento de Histórico:** A mudança de status via drag-and-drop gera um evento automático no histórico da instalação. |
| **1.2**  | Ana, Gerente de Operações  | cadastrar, visualizar, editar e remover clientes.                                                                 | eu possa manter um registro centralizado e organizado de todos os meus clientes.                         | - **CRUD de Clientes (`/admin/clients`):** Uma tabela exibe todos os clientes com busca por nome/documento.<br>- **Dialog de Criação/Edição:** Um formulário em `Dialog` permite criar ou editar clientes com os campos: Nome, Tipo (Pessoa Física/Jurídica), Documento (CPF/CNPJ), E-mail, Telefone e Endereço completo.<br>- **Vínculo com Instalações:** A tabela exibe um badge com o número de instalações vinculadas a cada cliente, que funciona como um link para a lista de instalações filtrada. |
| **1.3**  | Ana, Gerente de Operações  | criar uma nova instalação, associando-a a um cliente e inserindo dados iniciais.                                  | eu possa iniciar formalmente um novo projeto no sistema.                                                 | - **Dialog de Nova Instalação:** Acessível por um botão no cabeçalho, abre um formulário para: selecionar um cliente existente, definir tipo (residencial/comercial), nome da concessionária e nº de protocolo (opcional).<br>- **Geração de ID:** O sistema gera um ID único e um ID de instalação formatado (ex: `INST-001`).<br>- **Registro de Evento:** Se um número de protocolo é inserido, um evento de "Protocolo Aberto" é criado automaticamente. |
| **1.4**  | Ana, Gerente de Operações  | visualizar todos os detalhes de uma instalação específica em uma única página.                                      | eu possa ter um hub central de informações para gerenciar aquele projeto.                                | - **Página de Detalhes (`/admin/installation/[id]`):**<br>  - **Timeline Visual:** Exibe o progresso das 5 etapas principais (Protocolo, Projeto, Agendamento, Instalação, Homologação).<br>  - **Gestão de Status:** Menus `Select` para alterar os status de Instalação, Projeto e Homologação.<br>  - **Histórico de Eventos:** Timeline cronológica de todas as ações com ícones, data e descrição. Permite adicionar novos eventos manualmente.<br>  - **Anexos:** Galeria com todas as mídias (fotos do instalador, documentos do projeto) com preview.<br>  - **Dados do Relatório:** Visualização dos dados brutos enviados pelo técnico em uma aba dedicada. |
| **1.5**  | Ana, Gerente de Operações  | agendar a data e hora da instalação.                                                                              | eu possa planejar o cronograma da equipe de campo.                                                       | - **Dialog de Agendamento:** Na página da instalação, um dialog com `Calendar` e input de hora permite agendar a visita. Habilitado apenas se o status do projeto for "Aprovado".<br>- **Geração de Evento:** Agendar/Reagendar cria um evento no histórico.<br>- **Visão de Calendário (`/admin/calendar`):** Uma página com `react-big-calendar` exibe todas as instalações agendadas por mês, semana ou dia. Clicar em um evento leva para a página da instalação. |
| **1.6**  | Ana, Gerente de Operações  | alocar e gerenciar equipamentos (inversores, painéis) do inventário para uma instalação.                          | eu possa garantir que os equipamentos corretos estão reservados para cada projeto.                         | - **Inventário Central (`/admin/equipment`):** Tabela com abas para Inversores e Painéis Solares, com CRUD completo para cada tipo.<br>- **Dialog de Alocação:** Na página da instalação, um dialog lista equipamentos "Disponíveis" do inventário para seleção e alocação.<br>- **Busca de Equipamento (`/admin/equipment/search`):** Ferramenta para localizar um inversor por nº de série, ver a qual instalação está alocado e transferi-lo para outra. |
| **1.7**  | Ana, Gerente de Operações  | gerar um relatório técnico consolidado a partir dos dados do instalador usando IA.                                | eu possa ter um documento profissional para arquivamento e verificação final.                            | - **Botão "Gerar Relatório com IA":** Na página da instalação, aciona um flow Genkit que está habilitado somente após o envio do formulário do instalador.<br>- **Prompt de IA:** A IA recebe o JSON do relatório do instalador e gera um texto técnico formatado, incluindo nome do cliente, protocolo, análise de medições e conclusão.<br>- **Exibição e Cópia:** O relatório gerado é exibido em um campo de texto com um botão para cópia. |
| **1.8**  | Ana, Gerente de Operações  | personalizar os estágios (status) dos fluxos de trabalho.                                                          | eu possa adaptar o sistema aos processos específicos da minha empresa.                                     | - **Página de Configurações (`/admin/settings`):**<br>  - Permite adicionar, renomear, reordenar (via drag-and-drop) e excluir os status para os Kanbans de `Instalação`, `Projeto` e `Homologação`.<br>  - As alterações são salvas no `localStorage` e refletem imediatamente nos Kanbans e nos menus de seleção de status. |
| **1.9**  | Ana, Gerente de Operações  | arquivar instalações concluídas ou canceladas.                                                                    | para limpar minha visão principal, mas manter o histórico de dados.                                      | - **Ação de Arquivar/Desarquivar:** Disponível na lista de instalações e na página de detalhes. A ação só é habilitada se o status for "Concluído" ou "Cancelado".<br>- **Filtro:** A lista de instalações e os Kanbans não exibem itens arquivados por padrão.                                                                                                                                                                                                                                                                               |
| **1.10** | Ana, Gerente de Operações  | gerar versões para impressão da Ordem de Serviço e do Comprovante do Cliente.                                      | para ter documentos físicos para o instalador e para o cliente.                                          | - **Página de Impressão (`/admin/installation/[id]/print`):** Gera duas páginas em formato A4:<br>  1. **Ordem de Serviço:** Para o instalador, com dados do cliente, equipamentos e um QR Code para acesso ao formulário.<br>  2. **Comprovante do Cliente:** Com dados do cliente, resumo do processo e um QR Code para a página de acompanhamento. |

### Épico 2: Formulário de Campo do Instalador (`/`)

| ID   | Como um (Persona)     | Eu quero...                                                                        | Para que...                                                                            | Requisitos Funcionais Chave                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     - **Acesso Direto:** URL com parâmetro `?client=NomeDoCliente` preenche o nome do cliente automaticamente. Se o parâmetro não for fornecido, a página exibe um erro.<br>- **Formulário com Acordeão:** Seções colapsáveis para organização: Informações do Cliente, Detalhes dos Equipamentos, Medições VCC, Medições CA, Componentes e Cabeamento, Documentação Fotográfica e Verificação Final.<br>- **Campos Estruturados:** Campos de texto, número, rádio, switch e upload de arquivo para cada tipo de dado, com validação via Zod.<br>- **Upload de Mídia:** Permite o upload de 12 fotos com anotações e um vídeo da instalação. As mídias são convertidas para Base64 no lado do cliente antes do envio.<br>- **Salvamento Local:** Ao enviar, o formulário preenchido é salvo como um objeto JSON no `localStorage` do navegador do instalador, com a chave `report_[NomeDoCliente]`.<br>- **Atualização de Status:** O envio do relatório também atualiza a lista principal de instalações no `localStorage`, marcando o campo `reportSubmitted` como `true`. |
| **2.1**  | Carlos, Técnico Instalador | preencher um formulário completo e estruturado sobre a instalação.                 | eu possa registrar todas as informações técnicas necessárias de uma só vez, sem esquecer nada. | - **Acesso Direto:** URL com parâmetro `?client=NomeDoCliente` preenche o nome do cliente automaticamente. Se o parâmetro não for fornecido, a página exibe um erro.<br>- **Formulário com Acordeão:** Seções colapsáveis para organização: Informações do Cliente, Detalhes dos Equipamentos, Medições VCC, Medições CA, Componentes e Cabeamento, Documentação Fotográfica e Verificação Final.<br>- **Campos Estruturados:** Campos de texto, número, rádio, switch e upload de arquivo para cada tipo de dado, com validação via Zod.<br>- **Upload de Mídia:** Permite o upload de 12 fotos com anotações e um vídeo da instalação. As mídias são convertidas para Base64 no lado do cliente antes do envio.<br>- **Salvamento Local:** Ao enviar, o formulário preenchido é salvo como um objeto JSON no `localStorage` do navegador do instalador, com a chave `report_[NomeDoCliente]`.<br>- **Atualização de Status:** O envio do relatório também atualiza a lista principal de instalações no `localStorage`, marcando o campo `reportSubmitted` como `true`. |

### Épico 3: Portal de Acompanhamento do Cliente (`/status/[id]`)

| ID   | Como um (Persona)     | Eu quero...                                                             | Para que...                                                                               | Requisitos Funcionais Chave                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - **Acesso por Link Único:** Cada instalação tem uma URL exclusiva (`/status/[id]`) para esta página.<br>- **Timeline Simplificada:** Exibe as 5 etapas principais do processo (Protocolo, Análise, Agendamento, Execução, Homologação) com ícones de status (concluído, em andamento, pendente, erro).<br>- **Lista de Atualizações:** Mostra as últimas 5 atualizações públicas (eventos que não são "Nota Interna") do histórico da instalação. |
| **3.1**  | Sra. Lúcia, Cliente Final | acessar uma página simples com um link único para ver o status da minha instalação. | eu possa me manter informada sobre o progresso sem precisar entrar em contato com a empresa. | - **Acesso por Link Único:** Cada instalação tem uma URL exclusiva (`/status/[id]`) para esta página.<br>- **Timeline Simplificada:** Exibe as 5 etapas principais do processo (Protocolo, Análise, Agendamento, Execução, Homologação) com ícones de status (concluído, em andamento, pendente, erro).<br>- **Lista de Atualizações:** Mostra as últimas 5 atualizações públicas (eventos que não são "Nota Interna") do histórico da instalação. |

---

## 4. Requisitos Não-Funcionais

-   **Usabilidade:** A interface deve ser intuitiva, limpa e responsiva, com foco especial na experiência móvel do formulário do instalador. O design utiliza os componentes `ShadCN/UI`.
-   **Desempenho:** O Painel Administrativo deve carregar rapidamente. Ações como busca e filtragem são realizadas no lado do cliente.
-   **Segurança:** A estrutura de autenticação com `NextAuth` está implementada, mas desativada. O acesso à área `/admin` pode ser protegido ativando o middleware.
-   **Confiabilidade:** O uso de `localStorage` para salvar todos os dados da aplicação (instalações, clientes, relatórios, configurações) garante que nenhuma informação seja perdida devido a problemas de conectividade, mantendo o estado na máquina do usuário.
-   **Escalabilidade:** Embora a solução atual use `localStorage`, a arquitetura de dados (schemas Zod) está preparada para uma futura migração para um banco de dados centralizado (como Firestore) sem grandes refatorações.

---

## 5. Fora do Escopo (Versão 1.0)

-   **Gestão Financeira:** O sistema não incluirá faturamento, controle de custos ou orçamentos.
-   **Controle de Estoque Avançado:** O inventário é um registro de equipamentos, sem controle de níveis de estoque ou ordens de compra.
-   **Gestão de Equipes:** Não haverá funcionalidades para gerenciar escalas, férias ou produtividade da equipe de campo.
-   **Aplicativo Móvel Nativo:** A solução é inteiramente baseada na web (PWA-ready), sem um aplicativo nativo para iOS ou Android.
-   **Integração com CRM/ERP:** Não haverá integrações diretas com outros sistemas de gestão.
-   **Autenticação Ativa:** O fluxo de login e o middleware de autenticação estão preparados, mas desativados por padrão.

---

## 6. Métricas de Sucesso

-   **Redução do Tempo de Preenchimento:** O tempo que um instalador leva para preencher e enviar um relatório completo deve ser menor que 15 minutos.
-   **Adoção da Plataforma:** 100% das novas instalações devem ser gerenciadas através do SolarView Pro.
-   **Redução de Erros:** Diminuição no número de chamados ou retrabalho causado por informações incorretas ou faltantes do campo.
-   **Satisfação do Cliente:** Feedback positivo dos clientes sobre a transparência e a facilidade de acompanhar o projeto.
-   **Eficiência Operacional:** Redução do tempo que a equipe de back-office gasta para obter o status de um projeto.
